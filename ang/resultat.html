<!DOCTYPE html >
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
	<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
	<title>PolitiScales - Results</title>
	<link rel="icon" type="image/png" sizes="16x16" href="images/Politiscales-icone1.png">
	<link rel="stylesheet" href="style.css" type="text/css" media="screen" />
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<script type="application/javascript" src="flags.js"></script>
	<meta property="og:title" content="My result on PolitiScales" />
	<meta property="og:locale" content="en" />
	<meta property="og:description" content="PolitiScales is a political test using 8 ideological axes to help you situate yourself politically, or simply share your profile with your friends." />
</head>

<body>
<header>
	<div id="header">
		<div class="headerLeft"><a href="index.html"><i class="fa fa-home" aria-hidden="true"></i></a></div><!--
		--><div class="headerMiddle"><h1>PolitiScales</a></h1></div><!--
		--><div class="headerRight"><a href="aide.html" target="_blank"><i class="fa fa-question-circle-o " aria-hidden="true"></i></a></div>
	</div>
</header>

<div id="content">
	<div id="mainFrame">

		<h2>Résultats</h2>

		<p class="simpleText">
			The result of your PolitiScales is broken down into 8 axes. Each axis indicates your position in relation to two contradictory ideologies. Particular characteristics, displayed at the bottom of the page, can also complete your result. For more information on the different axes, <a href="aide.html" target="_blank">see the help page</a>.
		</p>

		<div class="flagDecoration"><canvas id="generatedFlag" width="512" height="256"></canvas><div id="slogan"></div></div>

		<hr/>

		<div class="columnContainer">
			<div class="columnLeft">

				<div class="axisDesc"><div class="axisDescLeft"><p>Constructivism</p></div><div class="axisDescRight"><p>Essentialism</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/constructivism.png" alt="Constructivisme" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="cAxisNeg" class="axisSubProgress axisConstructivism"><span id="cAxisNegText"></span></div><!--
				--><div id="cAxisMid" class="axisSubProgress axisNeutral"><span id="cAxisMidText"></span></div><!--
				--><div id="cAxisPos" class="axisSubProgress axisEssentialism"><span id="cAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/essentialism.png" alt="Essentialisme" \></div>

				<div class="axisDesc"><div class="axisDescLeft"><p>Rehabilitative justice</p></div><div class="axisDescRight"><p>Punitive justice</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/justice_soft.png" alt="Justice réhabilitative" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="jAxisNeg" class="axisSubProgress axisLiberal"><span id="jAxisNegText"></span></div><!--
				--><div id="jAxisMid" class="axisSubProgress axisNeutral"><span id="jAxisMidText"></span></div><!--
				--><div id="jAxisPos" class="axisSubProgress axisAuthoritarism"><span id="jAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/justice_hard.png" alt="Justice punitive" \></div>

				<div class="axisDesc"><div class="axisDescLeft"><p>Progressivism</p></div><div class="axisDescRight"><p>Conservatism</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/progressism.png" alt="Libertaire" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="sAxisNeg" class="axisSubProgress axisProgressism"><span id="sAxisNegText"></span></div><!--
				--><div id="sAxisMid" class="axisSubProgress axisNeutral"><span id="sAxisMidText"></span></div><!--
				--><div id="sAxisPos" class="axisSubProgress axisConservatism"><span id="sAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/conservatism.png" alt="Conservatisme" \></div>

				<div class="axisDesc"><div class="axisDescLeft"><p>Internationalism</p></div><div class="axisDescRight"><p>Nationalism</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/internationalism.png" alt="Internationalisme" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="bAxisNeg" class="axisSubProgress axisInternationalism"><span id="bAxisNegText"></span></div><!--
				--><div id="bAxisMid" class="axisSubProgress axisNeutral"><span id="bAxisMidText"></span></div><!--
				--><div id="bAxisPos" class="axisSubProgress axisNationalism"><span id="bAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/nationalism.png" alt="Nationalisme" \></div>

			</div>
			<div class="columnRight">

				<div class="axisDesc"><div class="axisDescLeft"><p>Communism</p></div><div class="axisDescRight"><p>Capitalism</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/communism.png" alt="Communisme" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="pAxisNeg" class="axisSubProgress axisCommunism"><span id="pAxisNegText"></span></div><!--
				--><div id="pAxisMid" class="axisSubProgress axisNeutral"><span id="pAxisMidText"></span></div><!--
				--><div id="pAxisPos" class="axisSubProgress axisCapitalism"><span id="pAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/capitalism.png" alt="Capitalisme" \></div>

				<div class="axisDesc"><div class="axisDescLeft"><p>Regulationism</p></div><div class="axisDescRight"><p>Let it happen</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/regulation.png" alt="Régulationnisme" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="mAxisNeg" class="axisSubProgress axisRegulation"><span id="mAxisNegText"></span></div><!--
				--><div id="mAxisMid" class="axisSubProgress axisNeutral"><span id="mAxisMidText"></span></div><!--
				--><div id="mAxisPos" class="axisSubProgress axisLaissez"><span id="mAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/laissezfaire.png" alt="Laissez-faire" \></div>

				<div class="axisDesc"><div class="axisDescLeft"><p>Ecology</p></div><div class="axisDescRight"><p>Productivism</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/ecology.png" alt="Écologie" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="eAxisNeg" class="axisSubProgress axisEcology"><span id="eAxisNegText"></span></div><!--
				--><div id="eAxisMid" class="axisSubProgress axisNeutral"><span id="eAxisMidText"></span></div><!--
				--><div id="eAxisPos" class="axisSubProgress axisProductivism"><span id="eAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/productivism.png" alt="Productivisme" \></div>

				<div class="axisDesc"><div class="axisDescLeft"><p>Revolution</p></div><div class="axisDescRight"><p>Reformism</p></div></div>
				<div class="axisEnd axisEndLeft"><img src="images/revolution.png" alt="Révolution" \></div><!--
				--><div class="axisProgress"><!--
				--><div id="tAxisNeg" class="axisSubProgress axisRevo"><span id="tAxisNegText"></span></div><!--
				--><div id="tAxisMid" class="axisSubProgress axisNeutral"><span id="tAxisMidText"></span></div><!--
				--><div id="tAxisPos" class="axisSubProgress axisRefo"><span id="tAxisPosText"></span></div>
				</div><!--
				--><div class="axisEnd axisEndRight"><img src="images/reformism.png" alt="Réformisme" \></div>

			</div>
		</div>
		<br/>
        <h2> </h2>
		<div id="bonusBox">
			<h2>Additional features</h2>


			<div id="anarBonus" class="description">
				<div class="descImg"><img src="images/anarchism.png" alt="Anarchisme"/></div><!--
				--><div class="descTextMono">
					<p><b>Anarchist : </b>when the people are beaten with a stick, they are no happier if the stick is called a "people's stick". The state is an oppression that must be removed.</p>
				</div>
			</div>
		
			<div id="pragBonus" class="description">
				<div class="descImg"><img src="images/pragmatism.png" alt="Pragmatisme"/></div><!--
				--><div class="descTextMono">
					<p><b>Pragmatist :</b> politics is about objectively looking at where the problems are, and trying to solve them with the means available. Philosophy and ideologies in general are put aside in favour of management.</p>
				</div>
			</div>
		
			<div id="femiBonus" class="description">
				<div class="descImg"><img src="images/feminism.png" alt="Féminisme radical"/></div><!--
				--><div class="descTextMono">
					<p><b>Radical feminism : </b>gender must disappear to put patriarchy to death.</p>
				</div>
			</div>
		
			<div id="compBonus" class="description">
				<div class="descImg"><img src="images/complotism.png" alt="Complotisme"/></div><!--
				--><div class="descTextMono">
					<p><b>Complotist : </b>The major problems in our society are the work of a small group of people. It is therefore essential to find them, inform the public of their objectives and neutralise them.</p>
				</div>
			</div>

			<div id="vegaBonus" class="description">
				<div class="descImg"><img src="images/veganism.png" alt="Véganisme"/></div><!--
				--><div class="descTextMono">
					<p><b>Vegan :</b> humans must stop the consumption and exploitation of so-called « sentient beings » at all costs.</p>
				</div>
			</div>
			
			<div id="monaBonus" class="description">
				<div class="descImg"><img src="images/monarchism.png" alt="Monarchisme"/></div><!--
				--><div class="descTextMono">
					<p><b>Monarchist : </b>society should be organised around a king.</p>
				</div>
			</div>
			
			<div id="reliBonus" class="description">
				<div class="descImg"><img src="images/religion.png" alt="Missionnaire"/></div><!--
				--><div class="descTextMono">
					<p><b>Missionary : </b>For you, religion is important, especially yours. It should therefore be spread as widely as possible across the globe.</p>
				</div>
			</div>
            
			<div id="reliBonus" class="description">
				<div class="descImg"><img src="images/religion.png" alt="Missionnaire"/></div><!--
				--><div class="descTextMono">
					<p><b>Missionary : <b>For you, religion is important, especially yours. It should therefore be spread as widely as possible across the globe.</p>
				</div>
			</div>
            
            <div id="laicBonus" class="description">
				<div class="descImg"><img src="images/laicite.png" alt="Laïcité"/></div><!--
				--><div class="descTextMono">
					<p><b>Secularism :</b> Religion should have no place in the political system and in all other sectors, but everyone can have a belief.</p>
				</div>
			</div>
            
            <div id="impeBonus" class="description">
				<div class="descImg"><img src="images/imperialism.png" alt="Imperialisme"/></div><!--
				--><div class="descTextMono">
					<p><b>Imperialist : </b>all nations must be politically, economically and militarily dependent on my nation.</p>
				</div>
			</div>
            
            <div id="resiBonus" class="description">
				<div class="descImg"><img src="images/resistance.png" alt="Résistance"/></div><!--
				--><div class="descTextMono">
					<p><b>Resistance :</b> When my country is in danger or needs me, I commit myself without hesitation.</p>
				</div>
		</div>
</div>

<h4 align="center">To save or share your result, copy the URL of the page from the address bar.</h4>

<script>
function getQueryVariable(variable)
{
	var query = window.location.search.substring(1);
	var vars = query.split("&");
	for(var i=0;i<vars.length;i++)
	{
		var pair = vars[i].split("=")
		if(pair[0] == variable)
		{
			if(pair[1] == "NaN")
			{
				return 0
			}
			else
			{
				return pair[1]/100;
			}
		}
	}
	return 0;
}

function setAxisValue(name, value)
{
	var axis = document.getElementById(name)
	if(!axis)
		return
	
	var text = document.getElementById(name+"Text")
	if(!text)
		return
	
	axis.style.width = ((100*value).toFixed(1) + "%");
	
	text.innerHTML = ((100*value).toFixed(0) + "%");
	if (text.offsetWidth > axis.offsetWidth)
		text.style.visibility = "hidden";
}

function setBonus(name, value, limit)
{
	axis = document.getElementById(name)
	if(!axis)
		return
	
	if(value > limit)
	{
		axis.style.display = "block";
		axis.style.opacity = value*value;
	}
	else
	{
		axis.style.display = "none";
	}
}

axes = [
	"c",
	"b",
	"p",
	"m",
	"s",
	"j",
	"e",
	"t"
]

bonus = {
	anar: 0.9,
	prag: 0.9,
	femi: 0.9,
	comp: 0.9,
	vega: 0.9,
	reli: 0.9,
	mona: 0.9,
    laic: 0.9,
    impe: 0.9,
    resi: 0.9,
}

characteristics = []

for(var i=0; i<axes.length; i++)
{
	negativeValue  = getQueryVariable(axes[i]+"0");
	positiveValue  = getQueryVariable(axes[i]+"1");
	setAxisValue(axes[i]+"AxisNeg", negativeValue);
	setAxisValue(axes[i]+"AxisPos", positiveValue);
	setAxisValue(axes[i]+"AxisMid", 1-negativeValue-positiveValue);
	
	if(negativeValue > positiveValue)
	{
		characteristics.push({ name: axes[i]+"0", value: negativeValue});
	}
	else
	{
		characteristics.push({ name: axes[i]+"1", value: positiveValue});
	}
}

bonusEnabled = 0
for(var b in bonus)
{
	
	value = getQueryVariable(b);
	
	setBonus(b+"Bonus", value, bonus[b]);
	
	if(value > bonus[b])
	{
		bonusEnabled = 1;
		characteristics.push({ name: b, value: value});
	}
}

characteristics.sort(function(a, b)
{
	return a.value < b.value;
});

charSlogan = {
	c0: "Equality",
	b0: "Humanity",
	b1: "Homeland",
	p0: "Socialism",
	p1: "Work",
	m1: "Freedom",
	s1: "Family",
	j0: "Justice",
	j1: "Order",
	e0: "Ecology",
	t0: "Revolution"
}

function findFlagColors()
{
	colors = [];
	
	for(var i=0; i<flagColors.length; i++)
	{
		var accepted = 1;
		
		var mainValue = 0;
		var mainValueFound = 0;
	
		for(var j=0; j<flagColors[i].cond.length; j++)
		{
			var charFound = 0;
			for(var k=0; k<characteristics.length; k++)
			{
				if(characteristics[k].name == flagColors[i].cond[j].name)
				{
					charFound = 1;
					if(characteristics[k].value < flagColors[i].cond[j].vmin || characteristics[k].value > flagColors[i].cond[j].vmax)
						accepted = 0;
					else if(!mainValueFound)
					{
						mainValueFound = 1;
						mainValue = characteristics[k].value;
					}
					
					break;
				}
			}
			
			if(!charFound)
				accepted = 0;
			
			if(!accepted)
				break;
		}
		
		if(accepted)
		{
			colors.push({ bgColor: flagColors[i].bgColor, fgColor: flagColors[i].fgColor, value: mainValue });
		}
	}
	
	colors.sort(function(a, b) { return a.value < b.value; });
	
	return colors;
}

function findFlagShape(numColors)
{
	for(var i=0; i<flagShapes.length; i++)
	{
		var accepted = 1;
		
		if(flagShapes[i].numColors > numColors)
			accepted = 0;
		else
		{
			for(var j=0; j<flagShapes[i].cond.length; j++)
			{
				var charFound = 0;
				for(var k=0; k<characteristics.length; k++)
				{
					if(characteristics[k].name == flagShapes[i].cond[j].name)
					{
						charFound = 1;
						if(characteristics[k].value < flagShapes[i].cond[j].vmin || characteristics[k].value > flagShapes[i].cond[j].vmax)
							accepted = 0;
						
						break;
					}
				}
				
				if(!charFound)
					accepted = 0;
				
				if(!accepted)
					break;
			}
		}
		
		if(accepted)
			return i;
	}
	
	return -1;
}

function findFlagSymbol()
{
	for(var i=0; i<flagSymbols.length; i++)
	{
		var accepted = 1;
		
		for(var j=0; j<flagSymbols[i].cond.length; j++)
		{
			var charFound = 0;
			for(var k=0; k<characteristics.length; k++)
			{
				if(characteristics[k].name == flagSymbols[i].cond[j].name)
				{
					charFound = 1;
					if(characteristics[k].value < flagSymbols[i].cond[j].vmin || characteristics[k].value > flagSymbols[i].cond[j].vmax)
						accepted = 0;
					
					break;
				}
			}
			
			if(!charFound)
				accepted = 0;
			
			if(!accepted)
				break;
		}
		
		if(accepted)
			return flagSymbols[i].id;
	}
	
	return -1;
}

generatedSlogan = "";
sloganDiv = document.getElementById("slogan");
if(sloganDiv)
{
	selectedSlogan = []
	
	for(var i=0; i<characteristics.length; i++)
	{
		if(characteristics[i].value > 0 && charSlogan.hasOwnProperty(characteristics[i].name))
		{
			selectedSlogan.push({ text: charSlogan[characteristics[i].name], value: characteristics[i].value });
		}
	}
	
	selectedSlogan.sort(function(a, b) { return a.value < b.value; });
	
	var counter = 0;
	for(var i=0; i<selectedSlogan.length; i++)
	{
		if(generatedSlogan != "")
			generatedSlogan += " · ";
		generatedSlogan += selectedSlogan[i].text;
		counter++;
		
		if(counter >= 3)
			break;
	}
	
	sloganDiv.innerHTML = generatedSlogan;
}

if(!bonusEnabled)
{
	bonusBox = document.getElementById("bonusBox")
	bonusBox.style.display = "none";
}

var sprites = new Image();
sprites.src = 'images/flag_sprites.png';

sprites.onload = function()
{
	flag = document.getElementById("generatedFlag");
	if(flag)
	{
		var ctx = flag.getContext("2d");
		
		var spriteX = 256;
		var spriteY = 128;
		var spriteS = 1.0;
		
		var symbolId = findFlagSymbol();
		var colors = findFlagColors();
		
		if(colors.length <= 0)
			colors.push({ bgColor: "#ffffff", fgColor: "#000000" });
		
		var flagId = findFlagShape(colors.length);
		
		if(flagId < 0)
		{
			ctx.beginPath();
			ctx.rect(0, 0, 512, 256);
			ctx.fillStyle = "#ffffff";
			ctx.fill();
		}
		else
		{
			for(var i=0; i<flagShapes[flagId].shapes.length; i++)
			{
				var path = flagShapes[flagId].shapes[i];
				var numPoints = path.length/2;
				
				ctx.beginPath();
				ctx.moveTo(path[1]*512, path[2]*256);
				
				for(var j=1; j<numPoints; j++)
				{
					ctx.lineTo(path[1+j*2+0]*512, path[1+j*2+1]*256);
				}
				ctx.fillStyle = colors[path[0]].bgColor;
				ctx.fill();
			}
			
			spriteX = flagShapes[flagId].symbol[0]*512;
			spriteY = flagShapes[flagId].symbol[1]*256;
			spriteS = flagShapes[flagId].symbol[2];
		}
		
		if(symbolId >= 0)
		{
			var tmpC = document.createElement('canvas');
			tmpC.width = sprites.width;
			tmpC.height = sprites.height;
			var tmpCtx = tmpC.getContext('2d');
			var coloredSprites = tmpCtx.getImageData(0, 0, tmpC.width, tmpC.height);
			
			tmpCtx.beginPath();
			tmpCtx.rect(0, 0, tmpC.width, tmpC.height);
			tmpCtx.fillStyle = colors[0].fgColor;
			tmpCtx.fill();
			
			tmpCtx.globalCompositeOperation = "destination-in";
			tmpCtx.drawImage(sprites, 0, 0);
			
			ctx.drawImage(tmpC, symbolId*128, 0, 128, 128, spriteX-64*spriteS, spriteY-64*spriteS, 128*spriteS, 128*spriteS);
		}
	}
}

</script>
</body>
</html>
